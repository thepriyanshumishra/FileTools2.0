import{F as d,G as Zr}from"./B5_f92kn.js";import{downloadZip as qr}from"./yXpB-xoz.js";var gr={},Dr=function(r,e,n,a,i){var o=new Worker(gr[e]||(gr[e]=URL.createObjectURL(new Blob([r+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(v){var t=v.data,u=t.$e$;if(u){var s=new Error(u[0]);s.code=u[1],s.stack=u[2],i(s,null)}else i(null,t)},o.postMessage(n,a),o},y=Uint8Array,S=Uint16Array,hr=Int32Array,er=new y([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nr=new y([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),yr=new y([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mr=function(r,e){for(var n=new S(31),a=0;a<31;++a)n[a]=e+=1<<r[a-1];for(var i=new hr(n[30]),a=1;a<30;++a)for(var o=n[a];o<n[a+1];++o)i[o]=o-n[a]<<5|a;return{b:n,r:i}},xr=mr(er,2),ar=xr.b,Ir=xr.r;ar[28]=258,Ir[258]=28;var Rr=mr(nr,0),kr=Rr.b,L=new S(32768);for(var c=0;c<32768;++c){var B=(c&43690)>>1|(c&21845)<<1;B=(B&52428)>>2|(B&13107)<<2,B=(B&61680)>>4|(B&3855)<<4,L[c]=((B&65280)>>8|(B&255)<<8)>>1}var I=function(r,e,n){for(var a=r.length,i=0,o=new S(e);i<a;++i)r[i]&&++o[r[i]-1];var v=new S(e);for(i=1;i<e;++i)v[i]=v[i-1]+o[i-1]<<1;var t;if(n){t=new S(1<<e);var u=15-e;for(i=0;i<a;++i)if(r[i])for(var s=i<<4|r[i],g=e-r[i],f=v[r[i]-1]++<<g,l=f|(1<<g)-1;f<=l;++f)t[L[f]>>u]=s}else for(t=new S(a),i=0;i<a;++i)r[i]&&(t[i]=L[v[r[i]-1]++]>>15-r[i]);return t},P=new y(288);for(var c=0;c<144;++c)P[c]=8;for(var c=144;c<256;++c)P[c]=9;for(var c=256;c<280;++c)P[c]=7;for(var c=280;c<288;++c)P[c]=8;var zr=new y(32);for(var c=0;c<32;++c)zr[c]=5;var Cr=I(P,9,1),Ar=I(zr,5,1),J=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},z=function(r,e,n){var a=e/8|0;return(r[a]|r[a+1]<<8)>>(e&7)&n},K=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},Fr=function(r){return(r+7)/8|0},N=function(r,e,n){return(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length),new y(r.subarray(e,n))},Mr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],h=function(r,e,n){var a=new Error(e||Mr[r]);if(a.code=r,Error.captureStackTrace&&Error.captureStackTrace(a,h),!n)throw a;return a},$r=function(r,e,n,a){var i=r.length,o=a?a.length:0;if(!i||e.f&&!e.l)return n||new y(0);var v=!n,t=v||e.i!=2,u=e.i;v&&(n=new y(i*3));var s=function(lr){var cr=n.length;if(lr>cr){var sr=new y(Math.max(cr*2,lr));sr.set(n),n=sr}},g=e.f||0,f=e.p||0,l=e.b||0,A=e.l,T=e.d,M=e.m,m=e.n,x=i*8;do{if(!A){g=z(r,f,1);var O=z(r,f+1,3);if(f+=3,O)if(O==1)A=Cr,T=Ar,M=9,m=5;else if(O==2){var R=z(r,f,31)+257,X=z(r,f+10,15)+4,E=R+z(r,f+5,31)+1;f+=14;for(var k=new y(E),Z=new y(19),w=0;w<X;++w)Z[yr[w]]=z(r,f+w*3,7);f+=X*3;for(var b=J(Z),Br=(1<<b)-1,Er=I(Z,b,1),w=0;w<E;){var fr=Er[z(r,f,Br)];f+=fr&15;var p=fr>>4;if(p<16)k[w++]=p;else{var q=0,j=0;for(p==16?(j=3+z(r,f,3),f+=2,q=k[w-1]):p==17?(j=3+z(r,f,7),f+=3):p==18&&(j=11+z(r,f,127),f+=7);j--;)k[w++]=q}}var tr=k.subarray(0,R),U=k.subarray(R);M=J(tr),m=J(U),A=I(tr,M,1),T=I(U,m,1)}else h(1);else{var p=Fr(f)+4,$=r[p-4]|r[p-3]<<8,W=p+$;if(W>i){u&&h(0);break}t&&s(l+$),n.set(r.subarray(p,W),l),e.b=l+=$,e.p=f=W*8,e.f=g;continue}if(f>x){u&&h(0);break}}t&&s(l+131072);for(var Sr=(1<<M)-1,Tr=(1<<m)-1,Q=f;;Q=f){var q=A[K(r,f)&Sr],D=q>>4;if(f+=q&15,f>x){u&&h(0);break}if(q||h(2),D<256)n[l++]=D;else if(D==256){Q=f,A=null;break}else{var or=D-254;if(D>264){var w=D-257,G=er[w];or=z(r,f,(1<<G)-1)+ar[w],f+=G}var V=T[K(r,f)&Tr],Y=V>>4;V||h(3),f+=V&15;var U=kr[Y];if(Y>3){var G=nr[Y];U+=K(r,f)&(1<<G)-1,f+=G}if(f>x){u&&h(0);break}t&&s(l+131072);var vr=l+or;if(l<U){var ur=o-U,Wr=Math.min(U,vr);for(ur+l<0&&h(3);l<Wr;++l)n[l]=a[ur+l]}for(;l<vr;++l)n[l]=n[l-U]}}e.l=A,e.p=Q,e.b=l,e.f=g,A&&(g=1,e.m=M,e.d=T,e.n=m)}while(!g);return l!=n.length&&v?N(n,0,l):n.subarray(0,l)},br=new y(0),Gr=function(r,e){var n={};for(var a in r)n[a]=r[a];for(var a in e)n[a]=e[a];return n},wr=function(r,e,n){for(var a=r(),i=r.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),v=0;v<a.length;++v){var t=a[v],u=o[v];if(typeof t=="function"){e+=";"+u+"=";var s=t.toString();if(t.prototype)if(s.indexOf("[native code]")!=-1){var g=s.indexOf(" ",8)+1;e+=s.slice(g,s.indexOf("(",g))}else{e+=s;for(var f in t.prototype)e+=";"+u+".prototype."+f+"="+t.prototype[f].toString()}else e+=s}else n[u]=t}return e},H=[],Pr=function(r){var e=[];for(var n in r)r[n].buffer&&e.push((r[n]=new r[n].constructor(r[n])).buffer);return e},Xr=function(r,e,n,a){if(!H[n]){for(var i="",o={},v=r.length-1,t=0;t<v;++t)i=wr(r[t],i,o);H[n]={c:wr(r[v],i,o),e:o}}var u=Gr({},H[n].e);return Dr(H[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",n,u,Pr(u),a)},jr=function(){return[y,S,hr,er,nr,yr,ar,kr,Cr,Ar,L,Mr,I,J,z,K,Fr,N,h,$r,ir,Or,Ur]},Or=function(r){return postMessage(r,[r.buffer])},Ur=function(r){return r&&{out:r.size&&new y(r.size),dictionary:r.dictionary}},Hr=function(r,e,n,a,i,o){var v=Xr(n,a,i,function(t,u){v.terminate(),o(t,u)});return v.postMessage([r,e],e.consume?[r.buffer]:[]),function(){v.terminate()}},F=function(r,e){return r[e]|r[e+1]<<8},C=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},_=function(r,e){return C(r,e)+C(r,e+4)*4294967296};function Jr(r,e,n){return n||(n=e,e={}),typeof n!="function"&&h(7),Hr(r,e,[jr],function(a){return Or(ir(a.data[0],Ur(a.data[1])))},1,n)}function ir(r,e){return $r(r,{i:2},e&&e.out,e&&e.dictionary)}var rr=typeof TextDecoder<"u"&&new TextDecoder,Kr=0;try{rr.decode(br,{stream:!0}),Kr=1}catch{}var Lr=function(r){for(var e="",n=0;;){var a=r[n++],i=(a>127)+(a>223)+(a>239);if(n+i>r.length)return{s:e,r:N(r,n-1)};i?i==3?(a=((a&15)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,e+=String.fromCharCode(55296|a>>10,56320|a&1023)):i&1?e+=String.fromCharCode((a&31)<<6|r[n++]&63):e+=String.fromCharCode((a&15)<<12|(r[n++]&63)<<6|r[n++]&63):e+=String.fromCharCode(a)}};function Nr(r,e){if(e){for(var n="",a=0;a<r.length;a+=16384)n+=String.fromCharCode.apply(null,r.subarray(a,a+16384));return n}else{if(rr)return rr.decode(r);var i=Lr(r),o=i.s,n=i.r;return n.length&&h(8),o}}var Qr=function(r,e){return e+30+F(r,e+26)+F(r,e+28)},Vr=function(r,e,n){var a=F(r,e+28),i=Nr(r.subarray(e+46,e+46+a),!(F(r,e+8)&2048)),o=e+46+a,v=C(r,e+20),t=n&&v==4294967295?Yr(r,o):[v,C(r,e+24),C(r,e+42)],u=t[0],s=t[1],g=t[2];return[F(r,e+10),u,s,i,o+F(r,e+30)+F(r,e+32),g]},Yr=function(r,e){for(;F(r,e)!=1;e+=4+F(r,e+2));return[_(r,e+12),_(r,e+4),_(r,e+20)]},pr=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(r){r()};function _r(r,e,n){n||(n=e,e={}),typeof n!="function"&&h(7);var a=[],i=function(){for(var m=0;m<a.length;++m)a[m]()},o={},v=function(m,x){pr(function(){n(m,x)})};pr(function(){v=n});for(var t=r.length-22;C(r,t)!=101010256;--t)if(!t||r.length-t>65558)return v(h(13,0,1),null),i;var u=F(r,t+8);if(u){var s=u,g=C(r,t+16),f=g==4294967295||s==65535;if(f){var l=C(r,t-12);f=C(r,l)==101075792,f&&(s=u=C(r,l+32),g=C(r,l+48))}for(var A=e&&e.filter,T=function(m){var x=Vr(r,g,f),O=x[0],p=x[1],$=x[2],W=x[3],R=x[4],X=x[5],E=Qr(r,X);g=R;var k=function(w,b){w?(i(),v(w,null)):(b&&(o[W]=b),--u||v(null,o))};if(!A||A({name:W,size:p,originalSize:$,compression:O}))if(!O)k(null,N(r,E,E+p));else if(O==8){var Z=r.subarray(E,E+p);if($<524288||p>.8*$)try{k(null,ir(Z,{out:new y($)}))}catch(w){k(w,null)}else a.push(Jr(Z,{size:$},k))}else k(h(14,"unknown compression type "+O,1),null);else k(null,null)},M=0;M<s;++M)T(M)}else v(null,{});return i}async function ne(r){d(["zip"],`extracting zip: ${r.name}`);const e=await r.arrayBuffer(),n=new Uint8Array(e);return new Promise((a,i)=>{_r(n,(o,v)=>{if(o){Zr(["zip"],`failed to extract zip: ${o.message}`),i(new Error(`Failed to extract zip: ${o.message}`));return}const t=Object.entries(v).filter(([u])=>!dr(u)).map(([u,s])=>({filename:u,data:new Uint8Array(s)}));d(["zip"],`extracted ${t.length} entries from ${r.name}`),a(t)})})}async function ae(r){d(["zip"],`creating zip with ${r.length} files`);const e=await qr(r).blob();return new Uint8Array(await e.arrayBuffer())}function dr(r){return r.startsWith(".")||r.includes("/__MACOSX/")||r.endsWith("/")}export{ae as createZip,ne as extractZip,dr as ignoreEntry};
